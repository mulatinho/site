<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- social -->
  <meta property="og:url" content="http://alex.mulatinho.net/2011/02/13/utilizando-a-saida-da-shell-na-linguagem-c.html">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Utilizando a saída da shell na linguagem C.">
  <meta property="og:site_name" content="Alexandre Mulatinho">
  <meta property="og:description" content="A blog about linux, open source, development and the life of an software engineer ;)">
  <meta property="og:image" content="https://mulatinho.files.wordpress.com/2017/07/img_20170322_140523390.jpg">
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:creator" content="@alexmulatinho" />

  <title>Utilizando a saída da shell na linguagem C.</title>
  <meta name="description" content="E em se falando novamente em coisas nerds, principalmente na parte da programação eu diria que o meu amor é o C e a minha paixão é o Shell Script, como na co...">
  <meta http-equiv="refresh" content="300" />

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://alex.mulatinho.net/2011/02/13/utilizando-a-saida-da-shell-na-linguagem-c.html">
  <link rel="alternate" type="application/rss+xml" title="Alexandre Mulatinho" href="/feed.xml">

  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-107281743-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <br/>
  <br/>

  <div class="wrapper">
    
    
    <a class="site-title" href="/">Alexandre Mulatinho</a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/blog/">Blog</a>
            
          
            
            
            <a class="page-link" href="/docs/">Docs</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/softwares/">Softwares</a>
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Utilizando a saída da shell na linguagem C.</h1>
    <p class="post-meta">
      <time datetime="2011-02-13T00:00:00-03:00" itemprop="datePublished">
        
        Feb 13, 2011
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>E em se falando novamente em coisas nerds, principalmente na parte da programação eu diria que o meu amor é o C e a minha paixão é o Shell Script, como na computação e também na vida podemos integrar dois sentimentos num único apenas. Há casos em que os opostos definivamente se atraem como em paixões platônicas em que o ódio e o amor estão constantemente juntos o que me faz lembrar uma frase de um poeta: ‘difícil é deixar viver…’ ligando estes conceitos a marginalidade da sociedade. Ora pois, se amar é tão gostoso por quê continuar amando é tão difícil? se odiar é tão ruim por quê o ódio continua presente em nossas vidas? são mistérios que como dizem por aí só descobriremos quando partirmos dessa pra melhor ou então num daqueles momentos que só se tem uma vez na vida. Como esquecer um grande amor que tenha sido perdido por um acidente, uma mentira, uma verdade? Viver é o algoritmo mais difícil de nossas vidas e pra isso devemos unir todas as linguages, sejam elas do amor ou do ódio para conseguirmos sobreviver dia-a-dia. Depois dessa confusão de idéias vai ae abaixo ‘uma pequena integração’ de C com Shell Script!</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="kt">char</span> <span class="o">*</span><span class="nf">getoutput</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">cmd</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>
  <span class="kt">int</span> <span class="n">totalbytez</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="n">memset</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>

  <span class="n">fp</span> <span class="o">=</span> <span class="n">popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">fgets</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fp</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">totalbytez</span><span class="o">+=</span><span class="n">strlen</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">totalbytez</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">)</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">realloc</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">totalbytez</span><span class="p">);</span>

    <span class="n">strncat</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strlen</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>


  </div>

  
    
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://alex.mulatinho.net/2011/02/13/utilizando-a-saida-da-shell-na-linguagem-c.html';
      this.page.identifier = 'http://alex.mulatinho.net/2011/02/13/utilizando-a-saida-da-shell-na-linguagem-c.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://mulatinho.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

      <p>A blog about linux, open source, development and the life of an software engineer ;)</p>

      <br/>
      <br/>

      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- mulato-blog -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5138819533079914"
     data-ad-slot="8675679252"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

      
    </div>

  </div>

</footer>


  </body>

</html>
